---
title: "Frequency Distribution"
author: "Peter Baumgartner"
date: "`r Sys.Date()`"
output: 
  html_notebook: 
    fig_caption: yes
    number_sections: yes
    theme: cerulean
    toc: yes
---


```{r setup, include=FALSE}
library(tidyverse)
library(moments)
knitr::opts_chunk$set(
    eval = TRUE,
    include = TRUE,
    collapse = TRUE,
    echo = FALSE,
    results = 'markup',
    error = TRUE,
    message = TRUE,
    warning = TRUE,
    comment = '##',
    highlight = TRUE,
    prompt = FALSE,
    strip.white = TRUE,
    tidy = TRUE
    )
theme_update(plot.title = element_text(hjust = 0.5))
```


# Create distributions

```{r create-distributions}
set.seed(1234)
d.normal <- as_tibble(rbeta(10000,5,5))
d.skewed.pos <- as_tibble(rbeta(10000,2,5))
d.skewed.neg <- as_tibble(rbeta(10000,5,2))
```

# Display distributions

## Normal distribution

```{r display-normal-distribution}
p.normal <- ggplot(d.normal, aes(value)) +
        geom_histogram(aes(y = ..density..), alpha = 0.25, fill = "blue", binwidth = .025) +
        stat_function(fun = dnorm, args = c(mean = mean(d.normal$value), sd = sd(d.normal$value)), col = "tomato") +
    labs(
        title = "Normal distribution",
        x = "Score",
        y = "Frequency"
    )
p.normal
```

## Distribution positively skewed

```{r display-positively-skewed}
p.skewed.pos <- ggplot(d.skewed.pos, aes(value)) +
        geom_histogram(aes(y = ..density..), alpha = 0.25, fill = "blue", binwidth = .025) +
        stat_function(fun = dnorm, args = c(mean = mean(d.skewed.pos$value), sd = sd(d.skewed.pos$value)), col = "tomato") +
    labs(
        title = "Positively skewed distribution",
        x = "Score",
        y = "Frequency"
    )
p.skewed.pos
```

## Distribution negatively skewed

```{r display-negatively-skewed}
p.skewed.neg <- ggplot(d.skewed.neg, aes(value)) +
        geom_histogram(aes(y = ..density..), alpha = 0.25, fill = "blue", binwidth = .025) +
        stat_function(fun = dnorm, args = c(mean = mean(d.skewed.neg$value), sd = sd(d.skewed.neg$value)), col = "tomato") +
    labs(
        title = "Negatively skewed distribution",
        x = "Score",
        y = "Frequency"
    )
p.skewed.neg
```

# Display mean and median

## Normal distributionn

```{r display-vlines-normal-distribution}

p.normal.line <- p.normal +
    geom_vline(
        xintercept = mean(d.normal$value),
        linetype = "dashed",
        color = "red",
        size = 2
        ) +
    geom_vline(
        xintercept = median(d.normal$value),
        linetype = "dashed",
        color = "black",
        size = 1
        ) +
    labs(caption = "dashed lines: red = mean, black = median")
    
p.normal.line

```

## Distribution positively skewed

```{r display-vlines-positively-skewed-distribution}

p.skewed.pos.line <- p.skewed.pos +
    geom_vline(
        xintercept = mean(d.skewed.pos$value),
        linetype = "dashed",
        color = "red",
        size = 1
        ) +
    geom_vline(
        xintercept = median(d.skewed.pos$value),
        linetype = "dashed",
        color = "black",
        size = 1
        ) +
    labs(caption = "dashed lines: red = mean, black = median")
p.skewed.pos.line

```

## Distribution negatively skewed

```{r display-vlines-negatively-skewed-distribution}

p.skewed.neg.line <- p.skewed.neg +
    geom_vline(
        xintercept = mean(d.skewed.neg$value),
        linetype = "dashed",
        color = "red",
        size = 1
        ) +
    geom_vline(
        xintercept = median(d.skewed.neg$value),
        linetype = "dashed",
        color = "black",
        size = 1
        ) +
    labs(caption = "dashed lines: red = mean, black = median")
p.skewed.neg.line

```
