---
title: "Frequency Distribution"
author: "Peter Baumgartner"
date: "`r Sys.Date()`"
output:
  html_notebook:
    fig_caption: yes
    number_sections: yes
    theme: cerulean
    toc: yes
  html_document:
    df_print: paged
    toc: yes
---


```{r setup, include=FALSE}
library(tidyverse)
library(modeest)
library(shiny)
knitr::opts_chunk$set(
    eval = TRUE,
    include = TRUE,
    collapse = TRUE,
    echo = FALSE,
    results = 'markup',
    error = TRUE,
    message = TRUE,
    warning = TRUE,
    comment = '##',
    highlight = TRUE,
    prompt = FALSE,
    strip.white = TRUE,
    tidy = TRUE
    )
theme_update(plot.title = element_text(hjust = 0.5))
```


# Create distributions

```{r create-distributions}
set.seed(1234) # tested also with 1111
d.normal <- as_tibble(rbeta(10000,5,5))
d.skewed.pos <- as_tibble(rbeta(10000,2,5))
d.skewed.neg <- as_tibble(rbeta(10000,5,2))
```

# Display distributions

## Histogram

```{r histogram}
ggplot(diamonds, aes(price)) +
    stat_function(fun = dnorm, 
              args = c(mean = mean(diamonds$price), 
              sd = sd(diamonds$price)),  col = "tomato") +
    geom_histogram(aes(y = ..density..), binwidth = 500)
```

## Normal distribution

```{r display-normal-distribution}
p.normal <- ggplot(d.normal, aes(value)) +
        geom_histogram(aes(y = ..density..),
                alpha = 0.25, fill = "blue", binwidth = .025) +
        stat_function(fun = dnorm, args = c(mean = mean(d.normal$value), sd = sd(d.normal$value)),  col = "tomato") +
    labs(
        title = "Normal distribution",
        x = "Score",
        y = "Frequency"
    )
p.normal
```

## Distribution positively skewed

```{r display-positively-skewed}
p.skewed.pos <- ggplot(d.skewed.pos, aes(value)) +
        geom_histogram(aes(y = ..density..), alpha = 0.25, fill = "blue", binwidth = .025) +
        stat_function(fun = dnorm, args = c(mean = mean(d.skewed.pos$value), sd = sd(d.skewed.pos$value)), col = "tomato") +
    labs(
        title = "Positively skewed distribution",
        x = "Score",
        y = "Frequency"
    )
p.skewed.pos
```

## Distribution negatively skewed

```{r display-negatively-skewed}
p.skewed.neg <- ggplot(d.skewed.neg, aes(value)) +
        geom_histogram(aes(y = ..density..), alpha = 0.25, fill = "blue", binwidth = .025) +
        stat_function(fun = dnorm, args = c(mean = mean(d.skewed.neg$value), sd = sd(d.skewed.neg$value)), col = "tomato") +
    labs(
        title = "Negatively skewed distribution",
        x = "Score",
        y = "Frequency"
    )
p.skewed.neg
```

# Display mean and median

## Normal distributionn

```{r display-vlines-normal-distribution}
library(modeest)
M <- mlv(d.normal$value, method = "discrete")[[1]]
p.normal.line <- p.normal +
    geom_vline(
        xintercept = M,
        linetype = "dashed",
        color = "yellow",
        size = 1
        ) +
    geom_vline(
        xintercept = mean(d.normal$value),
        linetype = "dotdash",
        color = "blue",
        size = 1
        ) +
    geom_vline(
        xintercept = median(d.normal$value),
        linetype = "twodash",
        color = "green",
        size = 1
        ) +
    labs(caption = "lines: black = mode, yellow = mean, green = median")
    
p.normal.line

```

## Distribution positively skewed

```{r display-vlines-positively-skewed-distribution}
library(modeest)
M.pos <- mlv(d.skewed.pos$value, method = "naive", bw = 0.025)[[1]]
p.skewed.pos.line <- p.skewed.pos +
    geom_vline(
        xintercept = M.pos,
        linetype = "dashed",
        color = "black",
        size = 1
        ) +
    geom_vline(
        xintercept = mean(d.skewed.pos$value),
        linetype = "dashed",
        color = "blue",
        size = 1
        ) +
    geom_vline(
        xintercept = median(d.skewed.pos$value),
        linetype = "dashed",
        color = "green",
        size = 1
        ) +
    labs(caption = "lines: black = mode, blue = mean, green = median")
p.skewed.pos.line

```

## Distribution negatively skewed

```{r display-vlines-negatively-skewed-distribution}
library(modeest)
M.neg <- mlv(d.skewed.neg$value, method = "naive", bw = 0.025)[[1]]
p.skewed.neg.line <- p.skewed.neg +
    geom_vline(
        xintercept = M.neg,
        linetype = "dashed",
        color = "black",
        size = 1
        ) +
    geom_vline(
        xintercept = mean(d.skewed.neg$value),
        linetype = "dashed",
        color = "blue",
        size = 1
        ) +
    geom_vline(
        xintercept = median(d.skewed.neg$value),
        linetype = "dashed",
        color = "green",
        size = 1
        ) +
    labs(caption = "lines: black = mode, blue = mean, green = median")
p.skewed.neg.line

```

